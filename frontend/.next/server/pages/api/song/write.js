"use strict";(()=>{var e={};e.id=862,e.ids=[862],e.modules={9344:e=>{e.exports=require("jsonwebtoken")},145:e=>{e.exports=require("next/dist/compiled/next-server/pages-api.runtime.prod.js")},6249:(e,t)=>{Object.defineProperty(t,"l",{enumerable:!0,get:function(){return function e(t,i){return i in t?t[i]:"then"in t&&"function"==typeof t.then?t.then(t=>e(t,i)):"function"==typeof t&&"default"===i?t:void 0}}})},8216:(e,t,i)=>{i.r(t),i.d(t,{config:()=>d,default:()=>s,routeModule:()=>c});var _={};i.r(_),i.d(_,{default:()=>a});var n=i(1802),r=i(7153),l=i(6249),o=i(7467);function a(e,t){"GET"===e.method&&o.N.write(e,t)}let s=(0,l.l)(_,"default"),d=(0,l.l)(_,"config"),c=new n.PagesAPIRouteModule({definition:{kind:r.x.PAGES_API,page:"/api/song/write",pathname:"/api/song/write",bundlePath:"",filename:""},userland:_})},7467:(e,t,i)=>{i.d(t,{N:()=>l});var _=i(8438),n=i(9983);let r=[{title:"03_Double_dream_-_Botanica_magia",description:"",length:"6:47",file_id:"1"},{title:"Alone_-_Nehilo_-_Nehilo",description:"",length:"2:47",file_id:"2"},{title:"Apnea_-_Anitek",description:"",length:"5:11",file_id:"3"},{title:"Baila_-_Alfonso_Lugo",description:"",length:"3:30",file_id:"4"},{title:"Bright_Red_and_March_Away_-_Ping_Pong_Club",description:"",length:"3:30",file_id:"Bright_Red_and_March_Away_-_Ping_Pong_Club"},{title:"Dance_tonight_-_Lollita_(2)",description:"",length:"3:30",file_id:"Dance_tonight_-_Lollita_(2)"},{title:"Fell_In_Love_With_Summer_-_Songwriterz_(2)",description:"",length:"3:30",file_id:"Fell_In_Love_With_Summer_-_Songwriterz_(2)"},{title:"Felony_-_Sam_Brown_(3)",description:"",length:"3:30",file_id:"Felony_-_Sam_Brown_(3)"},{title:"It_Is_Well_-_The_Devil_Music_Co._(2)",description:"",length:"3:30",file_id:"It_Is_Well_-_The_Devil_Music_Co._(2)"},{title:"Lover_-_Square_a_Saw",description:"",length:"3:30",file_id:"Lover_-_Square_a_Saw"},{title:"Molotov_Heart_-_radionowhere",description:"",length:"3:30",file_id:"Molotov_Heart_-_radionowhere"},{title:"Not_My_Problem_-_All_My_Friends_Hate_Me",description:"",length:"3:30",file_id:"Not_My_Problem_-_All_My_Friends_Hate_Me"},{title:"Samie_Bower_-_How_Far",description:"",length:"3:30",file_id:"Samie_Bower_-_How_Far"},{title:"Shower_Floor_-_Anitek",description:"",length:"3:30",file_id:"Shower_Floor_-_Anitek"},{title:"StimiBeats_-_Sunset",description:"",length:"3:30",file_id:"StimiBeats_-_Sunset"},{title:"Tale_Of_The_Elegance_-_Anitek",description:"",length:"3:30",file_id:"Tale_Of_The_Elegance_-_Anitek"},{title:"The_Deep_-_Anitek",description:"",length:"3:30",file_id:"The_Deep_-_Anitek"},{title:"The_Flood_-_BLC_MIRROR_CLB",description:"",length:"3:30",file_id:"The_Flood_-_BLC_MIRROR_CLB"},{title:"The_Mind_Orchestra_-_Enchanters_Nightshade",description:"",length:"3:30",file_id:"The_Mind_Orchestra_-_Enchanters_Nightshade"}],l={addToPlaylist:async(e,t)=>{try{let i=await (0,n.I)(e,t);if(!i)return;let{songId:r,playlistIds:l}=e.body;if(!r)return t.status(400).json({err:"No song selected"});for(let e of l)await _._.songInPlaylist.create({data:{songId:r,playlistId:e}});let o=await _._.playlist.findMany({where:{userId:i.id},include:{songs:{select:{songId:!0}}}});t.json({msg:"Added to these playlists",playlists:o})}catch(e){return console.log(e.message),t.status(500).json({err:"Radās kļūme"})}},create:async(e,t)=>{try{if(!await (0,n.I)(e,t))return;let{title:i,description:r,length:l,file_id:o}=e.body;if(!i)return t.status(400).json({err:"No title provided"});let a=await _._.song.create({data:{title:i,description:r,length:l,file_id:o}});t.json(a)}catch(e){return console.log(e.message),t.status(500).json({err:"Radās kļūme"})}},write:async(e,t)=>{try{for(let e of(await _._.songInPlaylist.deleteMany(),await _._.song.deleteMany(),r)){let t=await _._.song.create({data:{...e}});console.log(t)}t.json("OK")}catch(e){return console.log(e.message),t.status(500).json({err:"Radās kļūme"})}},getAll:async(e,t)=>{try{let e=await _._.song.findMany();t.json(e)}catch(e){return console.log(e.message),t.status(500).json({err:"Radās kļūme"})}}}},8438:(e,t,i)=>{i.d(t,{_:()=>_});let _=new(require("@prisma/client")).PrismaClient},9983:(e,t,i)=>{i.d(t,{I:()=>l});var _=i(9344),n=i.n(_),r=i(8438);let l=async(e,t)=>{try{let{refresh_token:i}=e.cookies;if(!i)return t.status(400).json({err:"Unauthorized"}),null;let _=n().verify(i,String(process.env.REFRESH_TOKEN_SECRET));if(!_)return t.status(400).json({err:"Unauthorized"}),null;let l=await r._.user.findFirst({where:{id:Number(_)}});if(!l)return t.status(400).json({err:"Unauthorized"}),null;return l}catch(e){console.log(e)}}},7153:(e,t)=>{var i;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return i}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(i||(i={}))},1802:(e,t,i)=>{e.exports=i(145)}};var t=require("../../../webpack-api-runtime.js");t.C(e);var i=t(t.s=8216);module.exports=i})();